# Access Requests

When a device needs to gain access to a secured Signal K server, it will use "Acceds Requests" to request and gain access to the server.

A device could be a display, engine sensor, temperature sensor.

Definitions:
* clientId: this a string that uniquely identifies a device. This could be a uuid, a combination of model number and serial number, or any other string.
* requestId: This is an id generated by the server and used by the client to correlate the request with the results. The client should not rely on the format or contents of this string.

## Device Requests
The device will send a REST request to the server:

`curl -k --header "Content-Type: application/json"  --request POST --data '{"clientId":"1234-45653-343453","description": "My Awesome Sensor"}'  https://localhost:3443/access/requests`

The server will return a json response with a request identifier:

`{"requestId":"60240a45-bbcb-46f0-8df6-c7a3e048bec0"}`

The server should then provide a process for an administrator to review and approve or deny the request.

In the mean time, a device should poll the server using the requestId in the response above to see if it has been granted access and get the token:

The request is pending:
```
$ curl -k https://localhost:3443/access/requests/ee759b2b-9051-4188-ab2d-56b97f2a58eb
{"status":"PENDING"}$ 
```

The request is denied:

```
$ curl -k https://localhost:3443/access/requests/ee759b2b-9051-4188-ab2d-56b97f2a58eb
{"status":"'DENIED'"}$ 
```

The request was approved:

```
$ curl -k https://localhost:3443/access/requests/ee759b2b-9051-4188-ab2d-56b97f2a58eb
{"status":"APPROVED","token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkZXZpY2UiOiIxMjM0LTQ1NjUzLTM0MzQ1MyIsImlhdCI6MTUzNjg4NDY5MSwiZXhwIjoxNTY4NDQyMjkxfQ.5wypdKin5Q-gsi9aQ8sN1XBAP8bt3tNBT1WiIttm3qM"}
```

On approval, the device would save the token in a secure way and use it when sending or requesting data. Subsequently, when a device gets an 'Access Denied' response, it should send a new request for access to get a new token.

