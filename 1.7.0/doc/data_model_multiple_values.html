<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Multiple Values</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> Signal K Specification</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Getting Started</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="start_using.html"><strong aria-hidden="true">2.1.</strong> Using SK</a></li><li class="chapter-item expanded "><a href="start_developing.html"><strong aria-hidden="true">2.2.</strong> Developing with SK</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Data Model</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="data_model.html"><strong aria-hidden="true">3.1.</strong> Full and Delta Models</a></li><li class="chapter-item expanded "><a href="data_model_multiple_values.html" class="active"><strong aria-hidden="true">3.2.</strong> Multiple Values</a></li><li class="chapter-item expanded "><a href="data_model_metadata.html"><strong aria-hidden="true">3.3.</strong> Metadata</a></li><li class="chapter-item expanded "><a href="sources.html"><strong aria-hidden="true">3.4.</strong> Sources</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> API</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="urls_ports.html"><strong aria-hidden="true">4.1.</strong> URLs and Ports</a></li><li class="chapter-item expanded "><a href="rest_api.html"><strong aria-hidden="true">4.2.</strong> REST API</a></li><li class="chapter-item expanded "><a href="streaming_api.html"><strong aria-hidden="true">4.3.</strong> Streaming API</a></li><li class="chapter-item expanded "><a href="subscription_protocol.html"><strong aria-hidden="true">4.4.</strong> Subscription Protocol</a></li><li class="chapter-item expanded "><a href="connection.html"><strong aria-hidden="true">4.5.</strong> Discovery &amp; Connection Establishment</a></li><li class="chapter-item expanded "><a href="notifications.html"><strong aria-hidden="true">4.6.</strong> Notifications</a></li><li class="chapter-item expanded "><a href="security.html"><strong aria-hidden="true">4.7.</strong> Security</a></li><li class="chapter-item expanded "><a href="request_response.html"><strong aria-hidden="true">4.8.</strong> Request/Response</a></li><li class="chapter-item expanded "><a href="put.html"><strong aria-hidden="true">4.9.</strong> PUT Requests</a></li></ol></li><li class="chapter-item expanded "><a href="how_to_help.html"><strong aria-hidden="true">5.</strong> How Can I Help?</a></li><li class="chapter-item expanded "><a href="vesselsBranch.html"><strong aria-hidden="true">6.</strong> Appendix A: Keys Reference (Vessel)</a></li><li class="chapter-item expanded "><a href="otherBranches.html"><strong aria-hidden="true">7.</strong> Appendix B: Keys Reference (Others)</a></li><li class="chapter-item expanded "><a href="changelog.html"><strong aria-hidden="true">8.</strong> Appendix C: Changelog</a></li><li class="chapter-item expanded "><a href="versioning.html"><strong aria-hidden="true">9.</strong> Appendix D: Versioning</a></li><li class="chapter-item expanded "><a href="access_requests.html"><strong aria-hidden="true">10.</strong> Appendix E: Access Requests</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="multiple-values-for-a-key"><a class="header" href="#multiple-values-for-a-key">Multiple Values for a Key</a></h1>
<p>There are two use cases for multiple values for a single data point</p>
<ul>
<li>Multiple instances of a common device-e.g. two engines or multiple batteries.</li>
<li>Multiple devices providing duplicate data-multiple values for the same Signal K key from different sensors. This is
fairly common as most boats have multiple sensors capable of generating the same data (but not necessarily the same
value). For example, course over ground (COG) may come from both a compass and GPS or a boat may be equipped with
multiple depth sounders.</li>
</ul>
<h2 id="multiple-instances-of-a-common-device"><a class="header" href="#multiple-instances-of-a-common-device">Multiple Instances of a Common Device</a></h2>
<p>Some parts of the Signal K schema are <strong>device oriented</strong>.</p>
<p>For example, many boats have multiple batteries. However each battery has multiple, common quantities like voltage,
current and temperature. In this case, it makes more sense for these values to be organized by instance. Therefore, in
the Signal K model, each battery bank is it’s own instance: for example <code>electrical.batteries.starter</code> and
<code>electrical.batteries.house</code>. Then beneath that prefix there are the various properties for each battery.</p>
<p>This organisation allows a user interface to organise the individual readings in meaningful groups and allows consumers
to query all the values related to that piece of equipment via the REST API. Furthermore, this structure maintains the
primary requirement that a given data value have a fixed and unique URI, but gives flexibility in the structure and
complexities of data.</p>
<p>The same device centric organisation is used within the <code>propulsion</code> subschema, to support the common use case of two
engines via <code>propulsion.port</code> and <code>propulsion.starboard</code>.</p>
<blockquote>
<p>The values <code>starter</code>, <code>house</code>, <code>port</code> and <code>starboard</code> are examples and not specified in the schema. You are free to
use application specific values within the regexp specified in the JSON schema.</p>
</blockquote>
<h2 id="multiple-devices-providing-duplicate-data"><a class="header" href="#multiple-devices-providing-duplicate-data">Multiple Devices Providing Duplicate Data</a></h2>
<p>It is quite possible for a key value to come from more than one device. Many modern devices have a built in GPS
receiver and as a result on any given boat there may be several sources of position, speed over ground, and heading.
Multiple depth sounders are also common, often installed to port and starboard on monohull sailboats or in each hull of
a catamaran.</p>
<p>Given that the validity of these various sources of data may change in a context-specific way, Signal K provides a
mechanism for these values to be grouped together so that the consumer of the data may choose which value (or values)
to display<a href="#fn_1"><sup>1</sup></a>.<a name="ln_1" id="ln_1"></a></p>
<p>When dealing with multiple sources of data, it becomes important to know where the data is coming from. Signal K
provides a mechanism for that in the form of the <code>sources</code> top level object and references into that object via the
<code>$source</code> property. See <a href="sources.html">sources</a> for detailed information on the structure of the <code>sources</code> object and how
it is referenced by the <code>$source</code> property.</p>
<p>The first source of a particular data point becomes the default source for that data and a normal Signal K object is
created.</p>
<pre><code class="language-json">{
  &quot;self&quot;: &quot;urn:mrn:signalk:uuid:c0d79334-4e25-4245-8892-54e8ccc8021d&quot;,
  &quot;version&quot;: &quot;0.9.0&quot;,
  &quot;vessels&quot;: {
    &quot;urn:mrn:signalk:uuid:c0d79334-4e25-4245-8892-54e8ccc8021d&quot;: {
      &quot;uuid&quot;: &quot;urn:mrn:signalk:uuid:c0d79334-4e25-4245-8892-54e8ccc8021d&quot;,
      &quot;navigation&quot;: {
        &quot;courseOverGroundTrue&quot;: {
          &quot;value&quot;: 3.61562407843144,
          &quot;$source&quot;: &quot;ttyUSB0.GP&quot;,
          &quot;timestamp&quot;: &quot;2017-04-03T06:14:04.451Z&quot;
        }
      }
    }
  }
}
</code></pre>
<p>It has come from device <code>sources.ttyUSB0.GP</code>, where further details can be found.</p>
<p>If another value with different source arrives, the Signal K server will add the <code>values</code> attribute with values from
both the first and second sources. The initial source‘s data will continue to populate the <code>value</code> property in the key.</p>
<pre><code class="language-json">{
  &quot;self&quot;: &quot;urn:mrn:signalk:uuid:c0d79334-4e25-4245-8892-54e8ccc8021d&quot;,
  &quot;version&quot;: &quot;0.9.0&quot;,
  &quot;vessels&quot;: {
    &quot;urn:mrn:signalk:uuid:c0d79334-4e25-4245-8892-54e8ccc8021d&quot;: {
      &quot;uuid&quot;: &quot;urn:mrn:signalk:uuid:c0d79334-4e25-4245-8892-54e8ccc8021d&quot;,
      &quot;navigation&quot;: {
        &quot;courseOverGroundTrue&quot;: {
          &quot;value&quot;: 3.615624078431440,
          &quot;$source&quot;: &quot;ttyUSB0.GP&quot;,
          &quot;timestamp&quot;: &quot;2017-04-03T06:14:04.451Z&quot;,
          &quot;values&quot;:{
            &quot;ttyUSB0.GP.RMC&quot;:{
              &quot;value&quot;: 3.615624078431440,
              &quot;timestamp&quot;: &quot;2017-04-03T06:14:04.451Z&quot;
            },
            &quot;n2k.ikommunicate.128267&quot;:{
              &quot;value&quot;: 3.615624078431453,
              &quot;timestamp&quot;: &quot;2017-04-03T06:14:04.451Z&quot;
            }
          }
        }
      }
    }
  },
  &quot;sources&quot;:{
    &quot;ttyUSB0&quot;: {
      &quot;GP&quot;: {
        &quot;sentences&quot;: {
          &quot;RMC&quot;: &quot;2017-04-03T06:14:04.451Z&quot;
        }
      }
    },
    &quot;ikommunicate&quot;: {
      &quot;2&quot;: {
        &quot;n2k&quot;: {
          &quot;src&quot;: &quot;2&quot;,
          &quot;pgns&quot;: {
            &quot;128267&quot;: &quot;2017-04-03T06:14:05.221Z&quot;
          }
        }
      }
    }
  }
}

</code></pre>
<h3 id="multiple-values-in-delta-messages"><a class="header" href="#multiple-values-in-delta-messages">Multiple Values in Delta Messages</a></h3>
<p>When a client subscribes to <code>navigation.courseOverGroundTrue</code>, they receive <em>all</em> the values held. The update message
does not include the <code>values</code> path, the case above looks like:</p>
<pre><code class="language-json">{
  &quot;context&quot;: &quot;vessels.urn:mrn:signalk:uuid:c0d79334-4e25-4245-8892-54e8ccc8021d&quot;,
  &quot;updates&quot;: [
    {
      &quot;source&quot;: {
        &quot;label&quot;: &quot;GPS-1&quot;,
        &quot;type&quot;: &quot;NMEA0183&quot;,
        &quot;talker&quot;: &quot;GP&quot;,
        &quot;sentence&quot;: &quot;RMC&quot;
      },
      &quot;timestamp&quot;: &quot;2017-04-03T06:14:04.451Z&quot;,
      &quot;values&quot;: [
        {
          &quot;path&quot;: &quot;navigation.courseOverGroundTrue&quot;,
          &quot;value&quot;: 3.615624078431440
        }
      ]
    },
    {
      &quot;source&quot;: {
        &quot;label&quot;: &quot;actisense&quot;,
        &quot;type&quot;: &quot;NMEA2000&quot;,
        &quot;src&quot;: &quot;115&quot;,
        &quot;pgn&quot;: 128267
      },
      &quot;timestamp&quot;: &quot;2017-04-03T06:14:04.451Z&quot;,
      &quot;values&quot;: [
        {
          &quot;path&quot;: &quot;navigation.courseOverGroundTrue&quot;,
          &quot;value&quot;: 3.615624078431453
        }
      ]
    }
  ]
}
</code></pre>
<p>Individual updates can be distinguished by their source.</p>
<p>If a client wants only the values of a specific source it should subscribe to a path that includes the full path under
<code>values</code> including the source reference key of the source. The source reference should be enclosed in square brackets:
<code>navigation.courseOverGroundTrue.values[n2k./dev/ikommunicate.128267]</code>. The client can retrieve the relevant data via
REST API.</p>
<p><strong>Note:</strong> The exact format of the update message is affected by the subscription policy. A policy of <code>instant</code> will
result in changes being sent immediately, so typically one item in <code>values</code> per update. A policy of <code>fixed</code> will result
in periodic updates which may contain many items in <code>values</code>.</p>
<p>The update allows grouping <code>values</code> by <code>source</code>.</p>
<hr />
<p><a id="fn_1" href="#ln_1">[1]</a> Specifying preferred sources is still an under-development enhancement to the Node
server.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="data_model.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                            <a rel="next" href="data_model_metadata.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="data_model.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    <a rel="next" href="data_model_metadata.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
    </body>
</html>
